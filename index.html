<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="estilos/style.css">
  <link rel="stylesheet" href="estilos/desktop.css" media="screen and (max-width: 1200px)">
  <link rel="stylesheet" href="estilos/tablet.css" media="screen and (max-width: 992px)"">
  <link rel="stylesheet" href="estilos/celular.css" media="screen and (max-width: 768px)">
  <title>Alura Challenge</title>
</head>
<body>
    <!-- Preciso Organizar melhor o html e refazer o responsivo -->
    <header>
        <a href="https://www.alura.com.br/" rel="external" target="_blank"><img src="imagens/Frame_6.png" alt="Alura"></a>
    </header>

    <main id="container">
            <section id="txt">
                <textarea name="texto" id="itxt" cols="30" rows="10" placeholder="Insira um texto aqui" autofocus required minlength="5"></textarea>
            </section>
            <section id="botoes">
                <button id="botao1">Criptografar</button>
                <button id="botao2">Descriptografar</button>
            </section>
            
            <section id="box">
                <div id="boxcontent1">
                    <img id="img" src="imagens/imagem.png" alt="algo">
                    <div id="msg">
                        <h1>Nenhuma mensagem encontrada</h1>
                        <p>Digite um texto que você deseja criptografar ou descriptografar</p>
                    </div>
                </div>

                <div id="boxcontent2">
                    <textarea name="out" id="iout" cols="30" rows="10" readonly placeholder="Nenhuma Mensagem"></textarea>
                    <button id="copy">Copiar</button>
                </div>
            </section>
    </main>

    <footer>
        <p>Site criado por <a href="https://github.com/ValentePG" rel="external" target="_blank" title="GitHub"><strong>Gabriel Valente</strong></a></p>
    </footer>
<script>
    
    document.getElementById("boxcontent2").style.display = "none";

    var botao1 = document.getElementById("botao1");
    botao1.onclick = criptografador;

    var botao2 = document.getElementById("botao2");
    botao2.onclick = desencriptografador;

    var botao3 = document.getElementById("copy");
    botao3.onclick = copy;

    /* Funções precisam de melhoria no código, mas funciona! */

    function copy(){

        var copia = document.querySelector("#iout");
        copia.select();
        alert("Mensagem Copiada!")
        document.execCommand("copy");
        document.getElementById("boxcontent1").style.display = "initial";
        document.getElementById("boxcontent2").style.display = "none";
        document.getElementById("itxt").value = ""
        document.getElementById("itxt").focus()
        
    }
    
    
    function validaFrase(frase) {

        var regex = /^[a-z\s!?,."]+$/;
        
        if (regex.test(fraseFormatada)) {
            return true
        } else {
            return false
        }
        // return fraseFormatada.normalize("NFD").replace(/[^1234567890.,!?a-z\s]/g, "").toLowerCase();
        
    }
  


    function criptografador(evento) {
        
        fraseFormatada = document.getElementById("itxt").value;

        if (fraseFormatada == ""){

            alert("Digite uma mensagem em minúsculas e sem acento!");
            document.getElementById("itxt").value = ""
            document.getElementById("itxt").focus()

        } else {

            if (validaFrase(fraseFormatada) == false){

                alert("Digite apenas Minúsculas e Sem Acento Por Favor!")
                document.getElementById("itxt").value = ""
                document.getElementById("itxt").focus()

            } else {

                fraseFormatada = fraseFormatada.replace(/a/g, "ai");
                fraseFormatada = fraseFormatada.replace(/e/g, "enter");
                fraseFormatada = fraseFormatada.replace(/i/g, "imes");
                fraseFormatada = fraseFormatada.replace(/o/g, "ober");
                fraseFormatada = fraseFormatada.replace(/u/g, "ufat");

                document.getElementById("boxcontent1").style.display = "none";
                document.getElementById("iout").innerHTML = fraseFormatada;
                document.getElementById("boxcontent2").style.display = "initial";
            }
        }
  
    }
  
    function desencriptografador(frase) {
        
        fraseFormatada = document.getElementById("itxt").value;
        if (fraseFormatada == ""){

            alert("O programa só funciona se você digitar algo né meu querido!");
            document.getElementById("itxt").value = "";
            document.getElementById("itxt").focus();

        } else {

            if (validaFrase(fraseFormatada) == false){

                alert("Digite apenas Minúsculas e Sem Acento Por Favor!");
                document.getElementById("itxt").value = "";
                document.getElementById("itxt").focus();

            } else {

                fraseFormatada = fraseFormatada.replace(/aimes/g, "ai");
                fraseFormatada = fraseFormatada.replace(/ai/g, "a");
                fraseFormatada = fraseFormatada.replace(/enter/g, "e");
                fraseFormatada = fraseFormatada.replace(/imes/g, "i");
                fraseFormatada = fraseFormatada.replace(/ober/g, "o");
                fraseFormatada = fraseFormatada.replace(/ufat/g, "u");

                document.getElementById("boxcontent1").style.display = "none";
                document.getElementById("iout").innerHTML = fraseFormatada
                document.getElementById("boxcontent2").style.display = "initial";
            }
        }
    }


</script>
</body>
</html>